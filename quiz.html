<!DOCTYPE html>
<html class="dark" lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Quiz Quest - Play</title>
    <link rel="icon" href="favicon.svg" type="image/svg+xml">
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com/css2?family=Spline+Sans:wght@300;400;500;600;700&amp;display=swap"
        rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=VT323&amp;display=swap" rel="stylesheet" />
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap"
        rel="stylesheet" />
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "var(--primary-color)",
                        "background-light": "#f6f6f8",
                        "background-dark": "#101022",
                        "retro-dark": "#05051a",
                        "retro-green": "#00ff00",
                        "retro-red": "#ff0000",
                        "retro-yellow": "#ffff00",
                    },
                    fontFamily: {
                        "display": ['"VT323"', "monospace"],
                        "retro": ['"VT323"', "monospace"],
                        "sans": ['"VT323"', "monospace"],
                    },
                    borderRadius: {
                        "DEFAULT": "0.125rem",
                        "lg": "0.25rem",
                        "xl": "0.5rem",
                        "full": "0.75rem"
                    },
                    backgroundImage: {
                        'scanlines': 'linear-gradient(to bottom, rgba(255,255,255,0), rgba(255,255,255,0) 50%, rgba(0,0,0,0.2) 50%, rgba(0,0,0,0.2))',
                    },
                    boxShadow: {
                        'retro': '4px 4px 0px 0px rgba(0,0,0,0.5)',
                        'retro-sm': '2px 2px 0px 0px rgba(0,0,0,0.5)',
                    }
                },
            },
        }
    </script>
    <style>
        /* Custom scrollbar for retro feel */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #101022;
        }

        ::-webkit-scrollbar-thumb {
            background: #323267;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-color);
        }

        .hidden {
            display: none !important;
        }

        /* CRT Flicker Animation */
        @keyframes flicker {
            0% {
                opacity: 0.97;
            }

            5% {
                opacity: 0.95;
            }

            10% {
                opacity: 0.9;
            }

            15% {
                opacity: 0.95;
            }

            20% {
                opacity: 0.99;
            }

            50% {
                opacity: 0.95;
            }

            80% {
                opacity: 0.98;
            }

            90% {
                opacity: 0.94;
            }

            100% {
                opacity: 0.98;
            }
        }

        .crt-flicker {
            animation: flicker 0.15s infinite;
            pointer-events: none;
        }

        .material-symbols-outlined {
            font-variation-settings: 'FILL' 1, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }
    </style>
</head>

<body
    class="bg-background-light dark:bg-background-dark font-display antialiased selection:bg-primary selection:text-white overflow-hidden">

    <!-- QUIZ GAME SCREEN -->
    <div class="flex items-center justify-center min-h-screen w-full bg-[#050510] p-4">
        <div id="quiz-screen"
            class="relative w-full max-w-md md:max-w-6xl bg-background-dark flex flex-col overflow-hidden border-2 border-[#323267] shadow-[0_0_50px_rgba(0,0,0,0.5)] rounded-lg h-[800px] max-h-[90vh]">
            <!-- CRT Overlay Effects -->
            <div class="absolute inset-0 z-50 pointer-events-none bg-scanlines bg-[length:100%_4px] opacity-10"></div>
            <div
                class="absolute inset-0 z-50 pointer-events-none bg-[radial-gradient(circle_at_center,transparent_50%,rgba(0,0,0,0.4)_100%)]">
            </div>

            <!-- Top App Bar: Status -->
            <header
                class="relative z-10 flex items-center justify-between bg-[#111122]/90 p-4 border-b-2 border-[#323267] backdrop-blur-sm shrink-0">
                <div class="flex flex-col">
                    <span class="text-[#9292c9] text-xs font-bold uppercase tracking-wider"
                        id="subject-label">Subject</span>
                    <h2 class="text-white text-xl font-extrabold leading-none tracking-tight" id="question-counter">1-1
                    </h2>
                </div>
                <!-- Hearts / Lives -->
                <div class="flex items-center gap-1 transition-opacity duration-300" id="lives-container">
                    <span class="material-symbols-outlined text-red-500 text-[20px]">favorite</span>
                    <span class="material-symbols-outlined text-red-500 text-[20px]">favorite</span>
                    <span class="material-symbols-outlined text-red-500 text-[20px]">favorite</span>
                </div>
            </header>

            <!-- Main Content Area -->
            <main class="flex-1 overflow-y-auto p-4 flex flex-col md:flex-row gap-6 relative z-10 scrollbar-hide">
                <!-- LEFT COLUMN DESKTOP: Stats + Question -->
                <div class="flex flex-col gap-4 md:w-1/2 md:h-full">
                    <!-- Dashboard: Timer & Score -->
                    <div class="bg-[#18182f] p-4 rounded border border-[#323267] shadow-[0_4px_0_0_#0d0d1a] transition-all duration-300"
                        id="hud-stats-container">
                        <!-- Timer -->
                        <div class="mb-4 transition-all duration-300" id="timer-container-ui">
                            <div class="flex justify-between items-end mb-1">
                                <label class="text-[#9292c9] text-xs font-bold tracking-widest">TIME FORCE</label>
                                <span class="text-white text-sm font-mono font-bold animate-pulse text-red-400"
                                    id="timer-display">--s</span>
                            </div>
                            <div class="h-4 w-full bg-[#0a0a16] rounded-sm p-[2px] border border-[#323267]">
                                <div id="timer-bar"
                                    class="h-full bg-gradient-to-r from-primary to-blue-400 w-[100%] rounded-sm relative overflow-hidden transition-all duration-1000 linear">
                                    <div
                                        class="absolute inset-0 bg-[linear-gradient(45deg,rgba(255,255,255,0.2)_25%,transparent_25%,transparent_50%,rgba(255,255,255,0.2)_50%,rgba(255,255,255,0.2)_75%,transparent_75%,transparent)] bg-[length:1rem_1rem] opacity-50">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Score -->
                        <div class="flex justify-between items-center border-t border-[#323267] pt-3"
                            id="score-container-ui">
                            <span class="text-[#9292c9] text-xs font-bold tracking-widest">SCORE</span>
                            <span
                                class="text-primary text-2xl font-mono font-bold tracking-widest drop-shadow-[0_0_8px_var(--primary-color)]"
                                id="score-display">00000</span>
                        </div>
                    </div>

                    <!-- Question Card -->
                    <div class="flex-1 flex flex-col justify-center min-h-[160px]">
                        <div
                            class="relative bg-primary/10 border-2 border-primary p-6 rounded-lg shadow-[0_0_15px_var(--primary-color)] md:h-full md:flex md:items-center md:justify-center">
                            <!-- Corner decorations -->
                            <div class="absolute -top-1 -left-1 w-2 h-2 bg-primary"></div>
                            <div class="absolute -top-1 -right-1 w-2 h-2 bg-primary"></div>
                            <div class="absolute -bottom-1 -left-1 w-2 h-2 bg-primary"></div>
                            <div class="absolute -bottom-1 -right-1 w-2 h-2 bg-primary"></div>
                            <h1 class="text-white text-xl md:text-3xl font-bold leading-tight text-center drop-shadow-md"
                                id="question-text">
                                Loading Mission...
                            </h1>
                        </div>
                        <!-- Report Button -->
                        <div class="flex justify-end mt-2">
                            <button id="report-btn"
                                class="text-xs text-[#9292c9] hover:text-white flex items-center gap-1 uppercase tracking-wider">
                                <span class="material-symbols-outlined text-[14px]">flag</span> Report Bug
                            </button>
                        </div>
                    </div>
                </div>

                <!-- RIGHT COLUMN DESKTOP: Answers -->
                <div class="md:w-1/2 md:flex md:flex-col md:justify-center">
                    <div class="flex flex-col gap-3 pb-4 md:grid md:grid-cols-2 md:gap-4 md:h-full md:content-center"
                        id="options-container">
                        <!-- Options injected by JS -->
                    </div>
                </div>
            </main>

            <!-- Footer Controls -->
            <footer class="relative z-10 bg-[#111122] border-t-2 border-[#323267] p-4">
                <div class="flex justify-between items-center max-w-[250px] mx-auto gap-2">
                    <button id="prev-btn"
                        class="p-3 rounded bg-[#232348] text-[#9292c9] hover:text-white hover:bg-primary/20 border border-transparent hover:border-primary transition-all active:scale-95 flex items-center justify-center disabled:opacity-30 disabled:cursor-not-allowed">
                        <span class="material-symbols-outlined">skip_previous</span>
                    </button>
                    <button id="home-btn"
                        class="p-3 rounded bg-[#232348] text-[#9292c9] hover:text-white hover:bg-primary/20 border border-transparent hover:border-primary transition-all active:scale-95 flex items-center justify-center">
                        <span class="material-symbols-outlined">home</span>
                    </button>
                    <!-- Next Btn (Hidden unless needed) -->
                    <button id="next-btn"
                        class="p-3 rounded bg-[#232348] text-[#9292c9] hover:text-white hover:bg-primary/20 border border-transparent hover:border-primary transition-all active:scale-95 flex items-center justify-center hidden">
                        <span class="material-symbols-outlined">skip_next</span>
                    </button>
                    <button id="help-btn"
                        class="p-3 rounded bg-[#232348] text-[#9292c9] hover:text-white hover:bg-primary/20 border border-transparent hover:border-primary transition-all active:scale-95 flex items-center justify-center opacity-50 cursor-not-allowed">
                        <span class="material-symbols-outlined">help</span>
                    </button>
                </div>
            </footer>
            <!-- EXPLANATION MODAL -->
            <div id="explanation-modal"
                class="fixed inset-0 z-[100] flex items-center justify-center bg-black/80 hidden">
                <div
                    class="relative w-full max-w-lg bg-[#232348] border-2 border-primary shadow-[0_0_30px_rgba(0,0,0,0.8)] rounded-lg p-6 m-4 animate-in fade-in zoom-in duration-200">
                    <!-- Close Button -->
                    <button id="close-explanation-btn"
                        class="absolute top-2 right-2 text-white/50 hover:text-white transition-colors">
                        <span class="material-symbols-outlined">close</span>
                    </button>

                    <!-- Header -->
                    <div class="flex items-center gap-3 mb-4 border-b border-white/10 pb-2">
                        <span class="material-symbols-outlined text-retro-yellow text-3xl">lightbulb</span>
                        <h2 class="text-2xl font-bold text-white font-retro tracking-wider">DEBRIEFING</h2>
                    </div>

                    <!-- Content -->
                    <div class="space-y-4">
                        <div class="bg-black/30 p-4 rounded border border-white/5">
                            <p class="text-[#9292c9] text-xs font-bold uppercase tracking-wider mb-1">RISPOSTA CORRETTA
                            </p>
                            <p class="text-retro-green font-bold text-lg leading-tight" id="explanation-correct-answer">
                                --</p>
                        </div>

                        <div>
                            <p class="text-[#9292c9] text-xs font-bold uppercase tracking-wider mb-2">SPIEGAZIONE
                                TATTICA</p>
                            <p class="text-white text-base leading-relaxed" id="explanation-text">
                                Dati non disponibili per questa missione.
                            </p>
                        </div>
                    </div>

                    <!-- Footer -->
                    <div class="mt-6 flex justify-end">
                        <button id="close-explanation-btn-2"
                            class="px-6 py-2 bg-primary text-white font-retro uppercase tracking-widest rounded hover:brightness-110 active:scale-95 transition-all">
                            RICEVUTO
                        </button>
                    </div>
                </div>
            </div>

        </div>

        <!-- RESULT SCREEN -->
        <div id="result-screen"
            class="relative min-h-screen w-full flex flex-col max-w-md mx-auto bg-primary border-x-4 border-white/10 shadow-2xl hidden">
            <!-- CRT Overlay -->
            <div class="fixed inset-0 scanlines pointer-events-none opacity-20"></div>
            <div class="absolute inset-0 bg-[#000033] opacity-30 pointer-events-none"></div>

            <header class="relative z-10 flex items-center justify-between p-4 bg-black/40 border-b-4 border-white/20">
                <button id="home-result-btn"
                    class="flex items-center justify-center p-2 hover:bg-white/10 rounded transition-colors group">
                    <span
                        class="material-symbols-outlined text-white group-hover:text-retro-yellow transition-colors">home</span>
                </button>
                <h1 class="text-3xl font-retro text-retro-yellow tracking-widest text-shadow">DEBRIEF</h1>
                <div class="w-8"></div> <!-- Spacer -->
            </header>

            <main class="flex-1 overflow-y-auto pb-24 relative z-10 px-4 pt-6 scrollbar-hide">
                <div class="text-center mb-6">
                    <h2 class="text-4xl md:text-5xl font-retro text-white uppercase tracking-wider drop-shadow-[2px_2px_0_rgba(0,0,0,1)] animate-pulse"
                        id="result-title">
                        MISSION<br /><span class="text-retro-green">COMPLETE</span>
                    </h2>
                    <div class="flex justify-center gap-1 mt-2" id="stars-container">
                        <!-- Stars injected here -->
                    </div>
                </div>

                <div
                    class="bg-black/50 border-4 border-white rounded-sm p-6 mb-6 text-center shadow-retro relative overflow-hidden">
                    <p class="text-lg font-retro text-white/80 mb-1 tracking-widest">FINAL SCORE</p>
                    <p class="text-6xl font-retro text-white leading-none tracking-widest drop-shadow-[4px_4px_0_rgba(255,0,0,0.5)]"
                        id="final-score">0</p>
                    <p class="text-sm font-retro text-white/50 tracking-widest mt-1" id="final-score-fraction">0/20</p>
                </div>

                <!-- Stats Grid -->
                <div class="grid grid-cols-2 gap-3 mb-8">
                    <!-- Accuracy -->
                    <div
                        class="bg-[#232348] border-2 border-white/30 p-3 rounded shadow-retro-sm flex flex-col items-center justify-center">
                        <span class="material-symbols-outlined text-retro-green mb-1 text-2xl">check_circle</span>
                        <span class="text-xs font-retro text-white/70 uppercase tracking-wide">Accuracy</span>
                        <span class="text-xl font-bold text-white" id="accuracy-display">0%</span>
                    </div>
                    <!-- XP Gained -->
                    <div
                        class="bg-[#232348] border-2 border-white/30 p-3 rounded shadow-retro-sm flex flex-col items-center justify-center">
                        <span class="material-symbols-outlined text-retro-yellow mb-1 text-2xl">bolt</span>
                        <span class="text-xs font-retro text-white/70 uppercase tracking-wide">XP Earned</span>
                        <span class="text-xl font-bold text-white text-primary" id="xp-earned-display">+0</span>
                    </div>
                </div>

                <!-- Save Score Input -->
                <div id="save-score-container" class="mb-6 hidden">
                    <div class="flex gap-2">
                        <input type="text" id="player-name" placeholder="INIT" maxlength="3"
                            class="bg-black/50 border-2 border-white text-white font-retro text-xl uppercase w-full p-2 text-center placeholder:text-white/20">
                        <button id="save-score-btn"
                            class="bg-primary text-white font-retro px-4 uppercase border-2 border-white hover:bg-white hover:text-primary transition-colors">Save</button>
                    </div>
                </div>

                <!-- Buttons -->
                <button id="restart-btn"
                    class="w-full bg-[#333355] border-b-4 border-[#111122] active:border-b-0 active:translate-y-1 hover:brightness-110 text-white font-retro text-xl py-4 rounded shadow-lg uppercase tracking-wider transition-all mb-4">
                    Replay Mission
                </button>
            </main>
        </div>

        <!-- Logic -->
        <script type="module" src="leaderboard.js"></script>
        <script type="module" src="leaderboard.js"></script>
        <script type="module" src="theme.js"></script>
        <script type="module" src="quiz.js?v=2"></script>
</body>

</html>